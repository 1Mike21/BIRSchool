import{h as U,l as m,m as I,o as i,c as u,d as l,n as w,i as v,u as p,F as x,f as k,b as S,t as M,q as D,p as O,k as T}from"./app-BXMhQWYf.js";const h=c=>(O("data-v-d58bf4c7"),c=c(),T(),c),N={class:"w-full flex flex-col"},V=h(()=>l("span",null,"Перетащите файлы сюда",-1)),$=h(()=>l("span",null,"ИЛИ",-1)),q=["multiple"],A={class:"bg-gray-50 p-2"},E={class:"w-full h-auto flex justify-start items-start flex-wrap relative mt-2"},H={key:0},G=h(()=>l("span",{class:"block font-medium text-sm text-gray-900"},"Загруженные файлы:",-1)),J=["onClick"],K=h(()=>l("span",{class:"block font-medium text-sm text-gray-900"},"Загруженные изображения:",-1)),P={class:"w-full h-auto flex justify-start items-start flex-wrap relative mt-2"},Q=["onClick"],W=["src","alt"],X={__name:"Dropzone",props:{multiple:{type:Boolean,default:!1},preview:Object},emits:["load"],setup(c,{emit:z}){const d=c,a=m(null),f=m(!1);let o=m([]),r=m([]);const B=z,_=()=>{f.value=!f.value},g=()=>{B("load",o,r)},F=(e,t,s)=>fetch(e).then(n=>n.arrayBuffer()).then(n=>new File([n],t,{type:s,lastModified:Date.now()})),j=()=>{d.preview&&(a.value.multiple||(a.value.disabled=!0),F(d.preview.url,d.preview.name,d.preview.type).then(e=>{e.type.split("/")[0]=="image"?(e.url=d.preview.url,r.value.push(e)):o.value.push(e)}),setTimeout(()=>{g()},1e3))};I(()=>{j()});const b=e=>{if(e.length!==0){for(let t=0;t<e.length;t++)e[t].type.split("/")[0]=="image"?r.value.some(s=>s.name===e[t].name)||(e[t].url=URL.createObjectURL(e[t]),r.value.push(e[t])):o.value.some(s=>s.name===e[t].name)||(e[t].url=URL.createObjectURL(e[t]),o.value.push(e[t]));g()}},C=e=>{a.value.multiple||(a.value.disabled=!0),b(e.target.files)},L=e=>{if(_(),!a.value.multiple){a.value.disabled=!0;const t=e.dataTransfer.files[0];if(!t)return;t.url=URL.createObjectURL(t),t.type.split("/")[0]=="image"?(r.value.length=0,r.value.push(t)):(o.value.length=0,o.value.push(t));return}b(e.dataTransfer.files)},y=(e,t)=>{a.value.disabled=!1,t.splice(e,1),g()};return(e,t)=>(i(),u("div",N,[l("div",{onDragenter:v(_,["prevent"]),onDragleave:v(_,["prevent"]),onDragover:t[0]||(t[0]=v(()=>{},["prevent"])),onDrop:v(L,["prevent"]),onChange:C,class:w([{active_dropzone:f.value},"flex flex-col justify-center bg-gray-50 text-block sm:text-sm p-2.5 transition-all duration-[.3s] items-center gap-y-4 border-2 border-dashed border-violetHoverButton rounded-md"])},[V,$,l("label",{class:w(["px-3 py-2 rounded-lg font-medium cursor-pointer text-white bg-violetButton transition-all duration-[.3s]",{"bg-white !text-violetButton":f.value}]),for:"dropzone"}," Выберите файл ",2),l("input",{class:"hidden",type:"file",ref_key:"dropzone",ref:a,multiple:c.multiple,id:"dropzone"},null,8,q)],34),l("div",A,[l("div",E,[p(o).length>0?(i(),u("div",H,[G,l("ul",null,[(i(!0),u(x,null,k(p(o),(s,n)=>(i(),u("li",{class:"flex items-center",key:n},[S(M(s.name)+" ",1),l("span",{class:"cursor-pointer ps-3 text-2xl text-rose-600",onClick:R=>y(n,p(o))},"×",8,J)]))),128))])])):D("",!0)]),p(r).length>0?(i(),u(x,{key:0},[K,l("div",P,[(i(!0),u(x,null,k(p(r),(s,n)=>(i(),u("div",{class:"w-20 h-20 mr-1 relative mb-2",key:n},[l("span",{class:"absolute top-1 right-2 cursor-pointer text-4xl text-rose-600",onClick:R=>y(n,p(r))},"×",8,Q),l("img",{ref_for:!0,ref:"previewImage",class:"w-full h-full rounded-lg",src:s.url,alt:s.name},null,8,W)]))),128))])],64)):D("",!0)])]))}},Z=U(X,[["__scopeId","data-v-d58bf4c7"]]);export{Z as D};
